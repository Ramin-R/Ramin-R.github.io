(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{131:function(e,t,a){"use strict";a.r(t);var n=a(31),r=a.n(n),s=a(0),i=a.n(s),o=a(136),c=a(135),l=a(20),u=a.n(l),h=a(33),m=a(62),d=a(15),p=a(16),f=a(24),y=a(23),g=a(25),v=a(32),k=a.n(v),E=a(53),b=function(e){return i.a.createElement("div",{className:"date-nav"},i.a.createElement("button",{onClick:function(){return e.handleMonthChange(-1)}},"<"),i.a.createElement("span",{className:"date-title"},"".concat(e.date.format("MMMM Y"))),i.a.createElement("button",{onClick:function(){return e.handleMonthChange(1)}},">"))},S=(a(38),function(e){return i.a.createElement("span",{"data-day":e.day,className:e.selectedDay,onClick:e.handleSelectedDayChange},e.day)}),D=function(e){return i.a.createElement("div",null,e.days.map(function(t,a){return i.a.createElement(S,{day:t,key:a,selectedDay:t===e.selectedDay?"selected days-of-week":" "===t?"disabled":"days-of-week",handleSelectedDayChange:" "===t?null:e.handleSelectedDayChange})}))},w=function(){return i.a.createElement("div",null,i.a.createElement("span",{className:"days-of-week"},"Su"),i.a.createElement("span",{className:"days-of-week"},"Mo"),i.a.createElement("span",{className:"days-of-week"},"Tu"),i.a.createElement("span",{className:"days-of-week"},"We"),i.a.createElement("span",{className:"days-of-week"},"Th"),i.a.createElement("span",{className:"days-of-week"},"Fr"),i.a.createElement("span",{className:"days-of-week"},"Sa"))},O=function(e){for(var t=e.weeks;t[0].length<7;)t[0].unshift(" ");var a=e.date.month()===e.selectedDay.month()&&e.date.year()===e.selectedDay.year();return i.a.createElement("div",{className:"month-days"},i.a.createElement("div",null,i.a.createElement(w,null),e.weeks.map(function(t,n){return i.a.createElement(D,{days:t,key:n,selectedDay:a?e.selectedDay.date():-1,handleSelectedDayChange:e.handleSelectedDayChange})})))},C=a(54),A=a(55),N=a.n(A)()(),j=function(){function e(){Object(d.a)(this,e),this.auth0=new C.a.WebAuth({domain:"ramin-r.auth0.com",clientID:"Hvch6U9gYof8ZBbcvG4NnpApDFKWCa5O",redirectUri:"https://ramin-r.github.io/",responseType:"token id_token",scope:"openid"}),this.login=this.login.bind(this),this.logout=this.logout.bind(this),this.handleAuthentication=this.handleAuthentication.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this)}return Object(p.a)(e,[{key:"login",value:function(){this.auth0.authorize()}},{key:"handleAuthentication",value:function(){var e=this;this.auth0.parseHash(function(t,a){a&&a.accessToken&&a.idToken?(e.setSession(a),N.replace("/")):t&&(N.replace("/"),console.log(t))})}},{key:"setSession",value:function(e){var t=JSON.stringify(1e3*e.expiresIn+(new Date).getTime());localStorage.setItem("access_token",e.accessToken),localStorage.setItem("id_token",e.idToken),localStorage.setItem("expires_at",t),N.replace("/")}},{key:"logout",value:function(){localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),N.replace("/")}},{key:"isAuthenticated",value:function(){var e=JSON.parse(localStorage.getItem("expires_at"));return(new Date).getTime()<e}}]),e}(),x=a(134),I=a(137),M=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"goTo",value:function(e){this.props.history.replace("/".concat(e))}},{key:"login",value:function(){this.props.auth.login()}},{key:"logout",value:function(){this.props.auth.logout()}},{key:"render",value:function(){var e=this.props.auth.isAuthenticated;return i.a.createElement("div",null,i.a.createElement(x.a,{fluid:!0},i.a.createElement(x.a.Header,null,!e()&&i.a.createElement(I.a,{bsStyle:"primary",className:"btn-margin login-btn",onClick:this.login.bind(this)},"Log In"),e()&&i.a.createElement(I.a,{bsStyle:"primary",className:"btn-margin login-btn",onClick:this.logout.bind(this)},"Log Out"))))}}]),t}(s.Component),_=function(e){return i.a.createElement("div",null,e.appointments.map(function(e,t){return i.a.createElement("div",{key:t,className:"appointments"},i.a.createElement("h2",null,e.date),i.a.createElement("p",null,e.text))}))},T=a(26),L=a.n(T),F=Object(E.extendMoment)(k.a),H=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(f.a)(this,Object(y.a)(t).call(this,e))).state={time:F().set({hour:0,minute:0,second:0,millisecond:0}),selectedDay:F().set({hour:0,minute:0,second:0,millisecond:0}),appointments:[],firstLogin:!0},a.arraysEqual=function(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(e[a]!==t[a])return!1;return!0},a.generateDays=function(){var e=F(a.state.time).startOf("month"),t=F(a.state.time).endOf("month"),n=[];F.range(e,t).by("days");var r=0;do{var s=F(e).startOf("week"),i=F(e).endOf("week");0===r&&(s=e),0!==r&&t.diff(e,"days")<7&&(i=t);var o=F.range(s,i),c=Array.from(o.by("days",{step:1}));e=i.add(1,"day"),n.push(c.map(function(e){return Number.parseInt(e.date())})),r++}while(t.diff(e,"days")>0);return n},a.handleMonthChange=function(e){var t=F(a.state.time);t.add(e,"month"),a.setState({time:t})},a.handleSelectedDayChange=function(e){var t=e.target.dataset.day,n=a.state.time.date(t);a.setState({selectedDay:n})},a.handleAppointment=function(e){e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=a.textInput.current.value,n=a.state.selectedDay.format("MMMM D Y");a.setState({appointments:Object(m.a)(a.state.appointments).concat([{date:n,text:t}])}),a.textInput.current.value=""},a.getAppointmentsFromServer=Object(h.a)(u.a.mark(function e(){var t,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=L()(localStorage.getItem("id_token")).sub,e.next=4,fetch("https://reactcalendar-ramin.herokuapp.com/".concat(t.split("|")[1]));case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,a.setState({firstLogin:!1,appointments:r.appointments}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),a.textInput=i.a.createRef(),a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.generateDays(),this.state.firstLogin&&this.props.auth.isAuthenticated()&&this.getAppointmentsFromServer()}},{key:"componentDidUpdate",value:function(e,t){var a,n=this;!this.arraysEqual(t.appointments,this.state.appointments)&&this.props.auth.isAuthenticated()&&(a=L()(localStorage.getItem("id_token")).sub,Object(h.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://reactcalendar-ramin.herokuapp.com//".concat(a.split("|")[1]),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({appointments:n.state.appointments})});case 2:case"end":return e.stop()}},e,this)}))()),this.props.auth.isAuthenticated()&&this.state.firstLogin&&(a=L()(localStorage.getItem("id_token")).sub,this.getAppointmentsFromServer())}},{key:"render",value:function(){var e=new j;return i.a.createElement("div",null,i.a.createElement("nav",{className:"nav-bar"},i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("h1",null,"React Calendar")),i.a.createElement("li",null,i.a.createElement(M,{auth:e,loginHandler:this.loginHandler})))),i.a.createElement(b,{handleMonthChange:this.handleMonthChange,date:this.state.time}),i.a.createElement(O,{date:this.state.time,weeks:this.generateDays(),selectedDay:this.state.selectedDay,handleSelectedDayChange:this.handleSelectedDayChange}),i.a.createElement("form",{onSubmit:this.handleAppointment},i.a.createElement("input",{type:"text",ref:this.textInput,className:"appointment-input",required:!0}),i.a.createElement("button",{className:"make-appoint-btn"},"Make Appointment")),i.a.createElement(_,{appointments:this.state.appointments}))}}]),t}(s.Component),J=function(e){return console.log(e.isAuthenticated),i.a.createElement("div",null,i.a.createElement("h1",null,"Loading..."))},q=new j;r.a.render(i.a.createElement(o.a,{history:N,component:H},i.a.createElement("div",null,i.a.createElement(c.a,{path:"/",exact:!0,render:function(e){return i.a.createElement(H,Object.assign({auth:q},e))}}),i.a.createElement(c.a,{path:"/callback",render:function(e){return/access_token|id_token|error/.test(e.location.hash)&&q.handleAuthentication(),i.a.createElement(J,e)}}))),document.getElementById("root"))},38:function(e,t,a){},63:function(e,t,a){e.exports=a(131)}},[[63,2,1]]]);
//# sourceMappingURL=main.80f457b5.chunk.js.map